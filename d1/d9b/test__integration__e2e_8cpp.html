<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Monitoring System: tests/test_integration_e2e.cpp File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Monitoring System
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_59425e443f801f1f2fd8bbe4959a3ccf.html">tests</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">test_integration_e2e.cpp File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>End-to-end integration tests for the monitoring system.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;gtest/gtest.h&gt;</code><br />
<code>#include &lt;thread&gt;</code><br />
<code>#include &lt;chrono&gt;</code><br />
<code>#include &lt;vector&gt;</code><br />
<code>#include &lt;atomic&gt;</code><br />
<code>#include &lt;random&gt;</code><br />
<code>#include &lt;fstream&gt;</code><br />
<code>#include &lt;filesystem&gt;</code><br />
<code>#include &lt;kcenon/monitoring/core/result_types.h&gt;</code><br />
<code>#include &lt;kcenon/monitoring/interfaces/monitoring_interface.h&gt;</code><br />
<code>#include &lt;kcenon/monitoring/tracing/distributed_tracer.h&gt;</code><br />
<code>#include &lt;kcenon/monitoring/performance/performance_monitor.h&gt;</code><br />
<code>#include &lt;kcenon/monitoring/adaptive/adaptive_monitor.h&gt;</code><br />
<code>#include &lt;kcenon/monitoring/health/health_monitor.h&gt;</code><br />
<code>#include &lt;kcenon/monitoring/reliability/circuit_breaker.h&gt;</code><br />
<code>#include &lt;kcenon/monitoring/reliability/retry_policy.h&gt;</code><br />
<code>#include &lt;kcenon/monitoring/reliability/fault_tolerance_manager.h&gt;</code><br />
<code>#include &lt;kcenon/monitoring/export/opentelemetry_adapter.h&gt;</code><br />
<code>#include &lt;kcenon/monitoring/export/trace_exporters.h&gt;</code><br />
<code>#include &lt;kcenon/monitoring/storage/storage_backends.h&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for test_integration_e2e.cpp:</div>
<div class="dyncontent">
<div class="center"><img src="../../d1/ddb/test__integration__e2e_8cpp__incl.png" border="0" usemap="#atests_2test__integration__e2e_8cpp" alt=""/></div>
<map name="atests_2test__integration__e2e_8cpp" id="atests_2test__integration__e2e_8cpp">
<area shape="rect" title="End&#45;to&#45;end integration tests for the monitoring system." alt="" coords="1139,5,1301,45"/>
<area shape="rect" title=" " alt="" coords="5,101,109,126"/>
<area shape="poly" title=" " alt="" coords="1139,32,622,54,332,73,213,84,122,96,105,100,104,94,121,91,212,78,332,67,621,49,1139,27"/>
<area shape="rect" title=" " alt="" coords="133,101,197,126"/>
<area shape="poly" title=" " alt="" coords="1139,31,931,38,663,50,400,69,292,81,210,96,201,98,200,93,209,91,291,76,400,64,662,45,931,32,1139,26"/>
<area shape="rect" title=" " alt="" coords="221,101,288,126"/>
<area shape="poly" title=" " alt="" coords="1139,32,706,52,471,71,374,83,301,96,292,98,290,93,299,91,373,77,470,66,706,47,1139,27"/>
<area shape="rect" title=" " alt="" coords="313,101,375,126"/>
<area shape="poly" title=" " alt="" coords="1139,33,749,54,540,73,454,84,389,96,381,98,379,93,387,91,453,78,539,67,749,49,1139,27"/>
<area shape="rect" title=" " alt="" coords="400,101,467,126"/>
<area shape="poly" title=" " alt="" coords="1139,29,1011,31,846,41,662,61,569,77,479,96,471,98,469,93,478,91,568,71,661,56,845,36,1011,26,1139,23"/>
<area shape="rect" title=" " alt="" coords="491,101,563,126"/>
<area shape="poly" title=" " alt="" coords="1139,31,1027,36,885,47,730,66,575,96,566,99,564,93,574,91,729,61,885,41,1026,30,1139,25"/>
<area shape="rect" title=" " alt="" coords="587,101,661,126"/>
<area shape="poly" title=" " alt="" coords="1139,33,927,52,800,70,674,96,664,99,663,94,673,91,799,65,927,47,1139,28"/>
<area shape="rect" title=" " alt="" coords="685,101,776,126"/>
<area shape="poly" title=" " alt="" coords="1140,38,977,60,882,76,789,96,776,99,775,94,787,91,881,71,976,55,1139,33"/>
<area shape="rect" title=" " alt="" coords="800,93,976,133"/>
<area shape="poly" title=" " alt="" coords="1148,48,974,93,973,87,1146,43"/>
<area shape="rect" title=" " alt="" coords="1000,93,1213,133"/>
<area shape="poly" title=" " alt="" coords="1196,48,1144,87,1141,83,1193,43"/>
<area shape="rect" title=" " alt="" coords="1238,93,1431,133"/>
<area shape="poly" title=" " alt="" coords="1247,43,1300,83,1297,87,1244,48"/>
<area shape="rect" title=" " alt="" coords="1455,93,1686,133"/>
<area shape="poly" title=" " alt="" coords="1298,43,1482,88,1480,93,1296,48"/>
<area shape="rect" title=" " alt="" coords="1711,93,1916,133"/>
<area shape="poly" title=" " alt="" coords="1301,35,1697,90,1697,96,1301,40"/>
<area shape="rect" title=" " alt="" coords="1940,93,2129,133"/>
<area shape="poly" title=" " alt="" coords="1301,30,1574,52,1927,91,1926,96,1574,57,1301,35"/>
<area shape="rect" title=" " alt="" coords="2153,93,2364,133"/>
<area shape="poly" title=" " alt="" coords="1301,28,1661,48,1897,66,2140,91,2139,96,1896,72,1660,54,1301,33"/>
<area shape="rect" title=" " alt="" coords="2388,93,2599,133"/>
<area shape="poly" title=" " alt="" coords="1301,26,1754,44,2060,63,2375,91,2374,96,2059,68,1753,49,1301,31"/>
<area shape="rect" title=" " alt="" coords="2623,93,2833,133"/>
<area shape="poly" title=" " alt="" coords="1301,25,1524,29,1845,39,2222,59,2609,91,2609,96,2221,64,1845,45,1524,34,1301,30"/>
<area shape="rect" title=" " alt="" coords="2858,93,3049,133"/>
<area shape="poly" title=" " alt="" coords="1301,24,1557,25,1936,33,2383,54,2615,70,2844,91,2844,96,2615,75,2383,59,1936,39,1557,30,1301,29"/>
<area shape="rect" title=" " alt="" coords="3073,93,3263,133"/>
<area shape="poly" title=" " alt="" coords="1301,25,2154,46,2670,66,2889,77,3059,91,3058,96,2888,83,2669,71,2154,52,1301,31"/>
<area shape="rect" title=" " alt="" coords="3288,93,3485,133"/>
<area shape="poly" title=" " alt="" coords="1301,25,2254,45,2836,64,3083,77,3275,91,3274,96,3083,82,2835,70,2254,50,1301,31"/>
</map>
</div>
</div>
<p><a href="../../d1/d9b/test__integration__e2e_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d9/d92/classIntegrationE2ETest.html">IntegrationE2ETest</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a488edffbb82c503b4fd8a79772a608c0" id="r_a488edffbb82c503b4fd8a79772a608c0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d9b/test__integration__e2e_8cpp.html#a488edffbb82c503b4fd8a79772a608c0">TEST_F</a> (<a class="el" href="../../d9/d92/classIntegrationE2ETest.html">IntegrationE2ETest</a>, StorageBackendIntegration)</td></tr>
<tr class="separator:a488edffbb82c503b4fd8a79772a608c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a70636d332f6e87d00b6c3fca35df35e1" id="r_a70636d332f6e87d00b6c3fca35df35e1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d9b/test__integration__e2e_8cpp.html#a70636d332f6e87d00b6c3fca35df35e1">TEST_F</a> (<a class="el" href="../../d9/d92/classIntegrationE2ETest.html">IntegrationE2ETest</a>, DistributedTracingE2E)</td></tr>
<tr class="separator:a70636d332f6e87d00b6c3fca35df35e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a682e953c7e7637be353153a0ee81b9e1" id="r_a682e953c7e7637be353153a0ee81b9e1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d9b/test__integration__e2e_8cpp.html#a682e953c7e7637be353153a0ee81b9e1">TEST_F</a> (<a class="el" href="../../d9/d92/classIntegrationE2ETest.html">IntegrationE2ETest</a>, HealthMonitoringWithRecovery)</td></tr>
<tr class="separator:a682e953c7e7637be353153a0ee81b9e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a592027d23ef36517b1967e304c0fbf01" id="r_a592027d23ef36517b1967e304c0fbf01"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d9b/test__integration__e2e_8cpp.html#a592027d23ef36517b1967e304c0fbf01">TEST_F</a> (<a class="el" href="../../d9/d92/classIntegrationE2ETest.html">IntegrationE2ETest</a>, PerformanceAdaptiveOptimization)</td></tr>
<tr class="separator:a592027d23ef36517b1967e304c0fbf01"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5f4fd19dd4d35e662f8ca4a44fc2549" id="r_ae5f4fd19dd4d35e662f8ca4a44fc2549"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d9b/test__integration__e2e_8cpp.html#ae5f4fd19dd4d35e662f8ca4a44fc2549">TEST_F</a> (<a class="el" href="../../d9/d92/classIntegrationE2ETest.html">IntegrationE2ETest</a>, CircuitBreakerAndRetry)</td></tr>
<tr class="separator:ae5f4fd19dd4d35e662f8ca4a44fc2549"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aab4269a9005d7046025f96d0b3411e76" id="r_aab4269a9005d7046025f96d0b3411e76"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d9b/test__integration__e2e_8cpp.html#aab4269a9005d7046025f96d0b3411e76">TEST_F</a> (<a class="el" href="../../d9/d92/classIntegrationE2ETest.html">IntegrationE2ETest</a>, ExportPipelineIntegration)</td></tr>
<tr class="separator:aab4269a9005d7046025f96d0b3411e76"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44e20b27be624999bd30ba9315acf094" id="r_a44e20b27be624999bd30ba9315acf094"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d9b/test__integration__e2e_8cpp.html#a44e20b27be624999bd30ba9315acf094">TEST_F</a> (<a class="el" href="../../d9/d92/classIntegrationE2ETest.html">IntegrationE2ETest</a>, FullSystemLoadTest)</td></tr>
<tr class="separator:a44e20b27be624999bd30ba9315acf094"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc1c0e68886466ae530a1f18b80f278d" id="r_afc1c0e68886466ae530a1f18b80f278d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d9b/test__integration__e2e_8cpp.html#afc1c0e68886466ae530a1f18b80f278d">TEST_F</a> (<a class="el" href="../../d9/d92/classIntegrationE2ETest.html">IntegrationE2ETest</a>, CrossComponentIntegration)</td></tr>
<tr class="separator:afc1c0e68886466ae530a1f18b80f278d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c04138a5bfe5d72780bb7e82a18e627" id="r_a3c04138a5bfe5d72780bb7e82a18e627"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/d9b/test__integration__e2e_8cpp.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a> (int argc, char **argv)</td></tr>
<tr class="separator:a3c04138a5bfe5d72780bb7e82a18e627"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>End-to-end integration tests for the monitoring system. </p>
<p>Tests complete workflows and interactions between all major components </p>

<p class="definition">Definition in file <a class="el" href="../../d1/d9b/test__integration__e2e_8cpp_source.html">test_integration_e2e.cpp</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a3c04138a5bfe5d72780bb7e82a18e627" name="a3c04138a5bfe5d72780bb7e82a18e627"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3c04138a5bfe5d72780bb7e82a18e627">&#9670;&#160;</a></span>main()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int main </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>argc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>argv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d1/d9b/test__integration__e2e_8cpp_source.html#l00545">545</a> of file <a class="el" href="../../d1/d9b/test__integration__e2e_8cpp_source.html">test_integration_e2e.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  545</span>                                {</div>
<div class="line"><span class="lineno">  546</span>    ::testing::InitGoogleTest(&amp;argc, argv);</div>
<div class="line"><span class="lineno">  547</span>    <span class="keywordflow">return</span> RUN_ALL_TESTS();</div>
<div class="line"><span class="lineno">  548</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae5f4fd19dd4d35e662f8ca4a44fc2549" name="ae5f4fd19dd4d35e662f8ca4a44fc2549"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae5f4fd19dd4d35e662f8ca4a44fc2549">&#9670;&#160;</a></span>TEST_F() <span class="overload">[1/8]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TEST_F </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d9/d92/classIntegrationE2ETest.html">IntegrationE2ETest</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CircuitBreakerAndRetry&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Test 5: Circuit Breaker and Retry Mechanism Failure injection → Circuit breaking → Recovery </p>

<p class="definition">Definition at line <a class="el" href="../../d1/d9b/test__integration__e2e_8cpp_source.html#l00293">293</a> of file <a class="el" href="../../d1/d9b/test__integration__e2e_8cpp_source.html">test_integration_e2e.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  293</span>                                                   {</div>
<div class="line"><span class="lineno">  294</span>    <span class="comment">// 1. Setup resilience components</span></div>
<div class="line"><span class="lineno">  295</span>    fault_tolerance_manager ft_manager;</div>
<div class="line"><span class="lineno">  296</span>    circuit_breaker breaker(3, std::chrono::milliseconds(100));</div>
<div class="line"><span class="lineno">  297</span>    retry_policy policy;</div>
<div class="line"><span class="lineno">  298</span>    policy.max_attempts = 5;</div>
<div class="line"><span class="lineno">  299</span>    policy.initial_delay = std::chrono::milliseconds(10);</div>
<div class="line"><span class="lineno">  300</span>    </div>
<div class="line"><span class="lineno">  301</span>    <span class="comment">// 2. Simulate component with intermittent failures</span></div>
<div class="line"><span class="lineno">  302</span>    std::atomic&lt;int&gt; call_count{0};</div>
<div class="line"><span class="lineno">  303</span>    std::atomic&lt;bool&gt; should_fail{<span class="keyword">true</span>};</div>
<div class="line"><span class="lineno">  304</span>    </div>
<div class="line"><span class="lineno">  305</span>    <span class="keyword">auto</span> unreliable_operation = [&amp;call_count, &amp;should_fail]() -&gt; result_void {</div>
<div class="line"><span class="lineno">  306</span>        call_count++;</div>
<div class="line"><span class="lineno">  307</span>        </div>
<div class="line"><span class="lineno">  308</span>        <span class="comment">// Fail first 3 calls, then succeed</span></div>
<div class="line"><span class="lineno">  309</span>        <span class="keywordflow">if</span> (call_count &lt;= 3 &amp;&amp; should_fail) {</div>
<div class="line"><span class="lineno">  310</span>            <span class="keywordflow">return</span> make_result_void(monitoring_error_code::operation_failed,</div>
<div class="line"><span class="lineno">  311</span>                                    <span class="stringliteral">&quot;Simulated failure&quot;</span>);</div>
<div class="line"><span class="lineno">  312</span>        }</div>
<div class="line"><span class="lineno">  313</span>        </div>
<div class="line"><span class="lineno">  314</span>        <span class="keywordflow">return</span> make_void_success();</div>
<div class="line"><span class="lineno">  315</span>    };</div>
<div class="line"><span class="lineno">  316</span>    </div>
<div class="line"><span class="lineno">  317</span>    <span class="comment">// 3. Test retry mechanism</span></div>
<div class="line"><span class="lineno">  318</span>    <span class="keyword">auto</span> retry_result = ft_manager.execute_with_retry(unreliable_operation, policy);</div>
<div class="line"><span class="lineno">  319</span>    EXPECT_TRUE(retry_result);</div>
<div class="line"><span class="lineno">  320</span>    EXPECT_EQ(call_count, 4); <span class="comment">// Failed 3 times, succeeded on 4th</span></div>
<div class="line"><span class="lineno">  321</span>    </div>
<div class="line"><span class="lineno">  322</span>    <span class="comment">// 4. Reset and test circuit breaker</span></div>
<div class="line"><span class="lineno">  323</span>    call_count = 0;</div>
<div class="line"><span class="lineno">  324</span>    should_fail = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  325</span>    </div>
<div class="line"><span class="lineno">  326</span>    <span class="comment">// Trigger circuit breaker with failures</span></div>
<div class="line"><span class="lineno">  327</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 3; ++i) {</div>
<div class="line"><span class="lineno">  328</span>        <span class="keyword">auto</span> cb_result = breaker.execute(unreliable_operation);</div>
<div class="line"><span class="lineno">  329</span>        EXPECT_FALSE(cb_result);</div>
<div class="line"><span class="lineno">  330</span>    }</div>
<div class="line"><span class="lineno">  331</span>    </div>
<div class="line"><span class="lineno">  332</span>    <span class="comment">// Circuit should be open</span></div>
<div class="line"><span class="lineno">  333</span>    EXPECT_EQ(breaker.get_state(), circuit_state::open);</div>
<div class="line"><span class="lineno">  334</span>    </div>
<div class="line"><span class="lineno">  335</span>    <span class="comment">// Further calls should fail fast (circuit open)</span></div>
<div class="line"><span class="lineno">  336</span>    <span class="keyword">auto</span> open_result = breaker.execute(unreliable_operation);</div>
<div class="line"><span class="lineno">  337</span>    EXPECT_FALSE(open_result);</div>
<div class="line"><span class="lineno">  338</span>    </div>
<div class="line"><span class="lineno">  339</span>    <span class="comment">// 5. Wait for circuit recovery</span></div>
<div class="line"><span class="lineno">  340</span>    std::this_thread::sleep_for(std::chrono::milliseconds(150));</div>
<div class="line"><span class="lineno">  341</span>    </div>
<div class="line"><span class="lineno">  342</span>    <span class="comment">// Allow success for recovery</span></div>
<div class="line"><span class="lineno">  343</span>    should_fail = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  344</span>    call_count = 0;</div>
<div class="line"><span class="lineno">  345</span>    </div>
<div class="line"><span class="lineno">  346</span>    <span class="comment">// Circuit should transition to half-open and then closed</span></div>
<div class="line"><span class="lineno">  347</span>    <span class="keyword">auto</span> recovery_result = breaker.execute(unreliable_operation);</div>
<div class="line"><span class="lineno">  348</span>    EXPECT_TRUE(recovery_result);</div>
<div class="line"><span class="lineno">  349</span>    EXPECT_EQ(breaker.get_state(), circuit_state::closed);</div>
<div class="line"><span class="lineno">  350</span>    </div>
<div class="line"><span class="lineno">  351</span>    <span class="comment">// 6. Verify system stability after recovery</span></div>
<div class="line"><span class="lineno">  352</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 5; ++i) {</div>
<div class="line"><span class="lineno">  353</span>        <span class="keyword">auto</span> stable_result = breaker.execute(unreliable_operation);</div>
<div class="line"><span class="lineno">  354</span>        EXPECT_TRUE(stable_result);</div>
<div class="line"><span class="lineno">  355</span>    }</div>
<div class="line"><span class="lineno">  356</span>    </div>
<div class="line"><span class="lineno">  357</span>    EXPECT_EQ(breaker.get_state(), circuit_state::closed);</div>
<div class="line"><span class="lineno">  358</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="afc1c0e68886466ae530a1f18b80f278d" name="afc1c0e68886466ae530a1f18b80f278d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc1c0e68886466ae530a1f18b80f278d">&#9670;&#160;</a></span>TEST_F() <span class="overload">[2/8]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TEST_F </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d9/d92/classIntegrationE2ETest.html">IntegrationE2ETest</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CrossComponentIntegration&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Test 8: Cross-Component Integration Multiple components working together </p>

<p class="definition">Definition at line <a class="el" href="../../d1/d9b/test__integration__e2e_8cpp_source.html#l00491">491</a> of file <a class="el" href="../../d1/d9b/test__integration__e2e_8cpp_source.html">test_integration_e2e.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  491</span>                                                      {</div>
<div class="line"><span class="lineno">  492</span>    <span class="comment">// 1. Create storage backend</span></div>
<div class="line"><span class="lineno">  493</span>    storage_config config;</div>
<div class="line"><span class="lineno">  494</span>    config.type = storage_backend_type::memory_buffer;</div>
<div class="line"><span class="lineno">  495</span>    config.max_capacity = 1000;</div>
<div class="line"><span class="lineno">  496</span>    <span class="keyword">auto</span> storage = std::make_unique&lt;memory_storage_backend&gt;(config);</div>
<div class="line"><span class="lineno">  497</span>    </div>
<div class="line"><span class="lineno">  498</span>    <span class="comment">// 2. Create tracer</span></div>
<div class="line"><span class="lineno">  499</span>    <span class="keyword">auto</span> tracer = std::make_unique&lt;distributed_tracer&gt;(<span class="stringliteral">&quot;integration_test&quot;</span>);</div>
<div class="line"><span class="lineno">  500</span>    </div>
<div class="line"><span class="lineno">  501</span>    <span class="comment">// 3. Create performance monitor</span></div>
<div class="line"><span class="lineno">  502</span>    <span class="keyword">auto</span> perf_monitor = performance_monitor::create();</div>
<div class="line"><span class="lineno">  503</span>    </div>
<div class="line"><span class="lineno">  504</span>    <span class="comment">// 4. Create metrics snapshot</span></div>
<div class="line"><span class="lineno">  505</span>    metrics_snapshot snapshot;</div>
<div class="line"><span class="lineno">  506</span>    </div>
<div class="line"><span class="lineno">  507</span>    <span class="comment">// Add performance metrics</span></div>
<div class="line"><span class="lineno">  508</span>    <span class="keyword">auto</span> cpu_usage = perf_monitor-&gt;measure_cpu_usage();</div>
<div class="line"><span class="lineno">  509</span>    <span class="keywordflow">if</span> (cpu_usage) {</div>
<div class="line"><span class="lineno">  510</span>        snapshot.add_metric(<span class="stringliteral">&quot;cpu_usage&quot;</span>, cpu_usage.value());</div>
<div class="line"><span class="lineno">  511</span>    }</div>
<div class="line"><span class="lineno">  512</span>    </div>
<div class="line"><span class="lineno">  513</span>    <span class="keyword">auto</span> memory_usage = perf_monitor-&gt;measure_memory_usage();</div>
<div class="line"><span class="lineno">  514</span>    <span class="keywordflow">if</span> (memory_usage) {</div>
<div class="line"><span class="lineno">  515</span>        snapshot.add_metric(<span class="stringliteral">&quot;memory_usage&quot;</span>, memory_usage.value());</div>
<div class="line"><span class="lineno">  516</span>    }</div>
<div class="line"><span class="lineno">  517</span>    </div>
<div class="line"><span class="lineno">  518</span>    <span class="comment">// 5. Store snapshot</span></div>
<div class="line"><span class="lineno">  519</span>    <span class="keyword">auto</span> store_result = storage-&gt;store(snapshot);</div>
<div class="line"><span class="lineno">  520</span>    EXPECT_TRUE(store_result);</div>
<div class="line"><span class="lineno">  521</span>    </div>
<div class="line"><span class="lineno">  522</span>    <span class="comment">// 6. Create trace span</span></div>
<div class="line"><span class="lineno">  523</span>    <span class="keyword">auto</span> span_result = tracer-&gt;start_span(<span class="stringliteral">&quot;cross_component_test&quot;</span>);</div>
<div class="line"><span class="lineno">  524</span>    ASSERT_TRUE(span_result);</div>
<div class="line"><span class="lineno">  525</span>    </div>
<div class="line"><span class="lineno">  526</span>    <span class="comment">// 7. Add metrics to span as attributes</span></div>
<div class="line"><span class="lineno">  527</span>    span_result.value().set_attribute(<span class="stringliteral">&quot;cpu_usage&quot;</span>, std::to_string(cpu_usage.value_or(0)));</div>
<div class="line"><span class="lineno">  528</span>    span_result.value().set_attribute(<span class="stringliteral">&quot;memory_usage&quot;</span>, std::to_string(memory_usage.value_or(0)));</div>
<div class="line"><span class="lineno">  529</span>    </div>
<div class="line"><span class="lineno">  530</span>    <span class="comment">// 8. Verify storage</span></div>
<div class="line"><span class="lineno">  531</span>    EXPECT_EQ(storage-&gt;size(), 1);</div>
<div class="line"><span class="lineno">  532</span>    </div>
<div class="line"><span class="lineno">  533</span>    <span class="keyword">auto</span> retrieved = storage-&gt;retrieve(0);</div>
<div class="line"><span class="lineno">  534</span>    EXPECT_TRUE(retrieved);</div>
<div class="line"><span class="lineno">  535</span>    </div>
<div class="line"><span class="lineno">  536</span>    <span class="comment">// 9. Verify metrics in retrieved snapshot</span></div>
<div class="line"><span class="lineno">  537</span>    <span class="keyword">auto</span> cpu_metric = retrieved.value().get_metric(<span class="stringliteral">&quot;cpu_usage&quot;</span>);</div>
<div class="line"><span class="lineno">  538</span>    EXPECT_TRUE(cpu_metric.has_value());</div>
<div class="line"><span class="lineno">  539</span>    </div>
<div class="line"><span class="lineno">  540</span>    <span class="keyword">auto</span> mem_metric = retrieved.value().get_metric(<span class="stringliteral">&quot;memory_usage&quot;</span>);</div>
<div class="line"><span class="lineno">  541</span>    EXPECT_TRUE(mem_metric.has_value());</div>
<div class="line"><span class="lineno">  542</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a70636d332f6e87d00b6c3fca35df35e1" name="a70636d332f6e87d00b6c3fca35df35e1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a70636d332f6e87d00b6c3fca35df35e1">&#9670;&#160;</a></span>TEST_F() <span class="overload">[3/8]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TEST_F </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d9/d92/classIntegrationE2ETest.html">IntegrationE2ETest</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">DistributedTracingE2E&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Test 2: Distributed Tracing End-to-End Span creation → Context propagation → Export </p>

<p class="definition">Definition at line <a class="el" href="../../d1/d9b/test__integration__e2e_8cpp_source.html#l00133">133</a> of file <a class="el" href="../../d1/d9b/test__integration__e2e_8cpp_source.html">test_integration_e2e.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  133</span>                                                  {</div>
<div class="line"><span class="lineno">  134</span>    <span class="comment">// 1. Setup tracing components</span></div>
<div class="line"><span class="lineno">  135</span>    <span class="keyword">auto</span> tracer = std::make_unique&lt;distributed_tracer&gt;(<span class="stringliteral">&quot;e2e_service&quot;</span>);</div>
<div class="line"><span class="lineno">  136</span>    <span class="keyword">auto</span> otel_adapter = create_opentelemetry_compatibility_layer(<span class="stringliteral">&quot;e2e_service&quot;</span>, <span class="stringliteral">&quot;1.0.0&quot;</span>);</div>
<div class="line"><span class="lineno">  137</span>    </div>
<div class="line"><span class="lineno">  138</span>    <span class="comment">// 2. Initialize OTEL adapter</span></div>
<div class="line"><span class="lineno">  139</span>    <span class="keyword">auto</span> init_result = otel_adapter-&gt;initialize();</div>
<div class="line"><span class="lineno">  140</span>    ASSERT_TRUE(init_result);</div>
<div class="line"><span class="lineno">  141</span>    </div>
<div class="line"><span class="lineno">  142</span>    <span class="comment">// 3. Create parent span</span></div>
<div class="line"><span class="lineno">  143</span>    <span class="keyword">auto</span> parent_span = tracer-&gt;start_span(<span class="stringliteral">&quot;parent_operation&quot;</span>);</div>
<div class="line"><span class="lineno">  144</span>    ASSERT_TRUE(parent_span);</div>
<div class="line"><span class="lineno">  145</span>    </div>
<div class="line"><span class="lineno">  146</span>    <span class="comment">// 4. Create child span with parent context</span></div>
<div class="line"><span class="lineno">  147</span>    <span class="keyword">auto</span> child_span = tracer-&gt;start_span(<span class="stringliteral">&quot;child_operation&quot;</span>, parent_span.value());</div>
<div class="line"><span class="lineno">  148</span>    ASSERT_TRUE(child_span);</div>
<div class="line"><span class="lineno">  149</span>    </div>
<div class="line"><span class="lineno">  150</span>    <span class="comment">// 5. Add events and attributes</span></div>
<div class="line"><span class="lineno">  151</span>    child_span.value().add_event(<span class="stringliteral">&quot;processing_started&quot;</span>);</div>
<div class="line"><span class="lineno">  152</span>    child_span.value().set_attribute(<span class="stringliteral">&quot;user_id&quot;</span>, <span class="stringliteral">&quot;test_user&quot;</span>);</div>
<div class="line"><span class="lineno">  153</span>    child_span.value().set_attribute(<span class="stringliteral">&quot;request_id&quot;</span>, <span class="stringliteral">&quot;req_123&quot;</span>);</div>
<div class="line"><span class="lineno">  154</span>    </div>
<div class="line"><span class="lineno">  155</span>    <span class="comment">// 6. Simulate error</span></div>
<div class="line"><span class="lineno">  156</span>    child_span.value().set_error(<span class="keyword">true</span>, <span class="stringliteral">&quot;Simulated error for testing&quot;</span>);</div>
<div class="line"><span class="lineno">  157</span>    </div>
<div class="line"><span class="lineno">  158</span>    <span class="comment">// 7. Export spans through OTEL adapter</span></div>
<div class="line"><span class="lineno">  159</span>    std::vector&lt;trace_span&gt; spans;</div>
<div class="line"><span class="lineno">  160</span>    spans.push_back(parent_span.value());</div>
<div class="line"><span class="lineno">  161</span>    spans.push_back(child_span.value());</div>
<div class="line"><span class="lineno">  162</span>    </div>
<div class="line"><span class="lineno">  163</span>    <span class="keyword">auto</span> export_result = otel_adapter-&gt;export_spans(spans);</div>
<div class="line"><span class="lineno">  164</span>    EXPECT_TRUE(export_result);</div>
<div class="line"><span class="lineno">  165</span>    </div>
<div class="line"><span class="lineno">  166</span>    <span class="comment">// 8. Verify stats</span></div>
<div class="line"><span class="lineno">  167</span>    <span class="keyword">auto</span> stats = otel_adapter-&gt;get_stats();</div>
<div class="line"><span class="lineno">  168</span>    EXPECT_GT(stats.pending_spans, 0);</div>
<div class="line"><span class="lineno">  169</span>    </div>
<div class="line"><span class="lineno">  170</span>    <span class="comment">// 9. Flush</span></div>
<div class="line"><span class="lineno">  171</span>    <span class="keyword">auto</span> flush_result = otel_adapter-&gt;flush();</div>
<div class="line"><span class="lineno">  172</span>    EXPECT_TRUE(flush_result);</div>
<div class="line"><span class="lineno">  173</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aab4269a9005d7046025f96d0b3411e76" name="aab4269a9005d7046025f96d0b3411e76"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aab4269a9005d7046025f96d0b3411e76">&#9670;&#160;</a></span>TEST_F() <span class="overload">[4/8]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TEST_F </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d9/d92/classIntegrationE2ETest.html">IntegrationE2ETest</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ExportPipelineIntegration&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Test 6: Export Pipeline Integration Trace and storage export verification </p>

<p class="definition">Definition at line <a class="el" href="../../d1/d9b/test__integration__e2e_8cpp_source.html#l00364">364</a> of file <a class="el" href="../../d1/d9b/test__integration__e2e_8cpp_source.html">test_integration_e2e.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  364</span>                                                      {</div>
<div class="line"><span class="lineno">  365</span>    <span class="comment">// 1. Setup OTEL adapter</span></div>
<div class="line"><span class="lineno">  366</span>    <span class="keyword">auto</span> otel_adapter = create_opentelemetry_compatibility_layer(<span class="stringliteral">&quot;export_test&quot;</span>, <span class="stringliteral">&quot;1.0.0&quot;</span>);</div>
<div class="line"><span class="lineno">  367</span>    <span class="keyword">auto</span> init_result = otel_adapter-&gt;initialize();</div>
<div class="line"><span class="lineno">  368</span>    ASSERT_TRUE(init_result);</div>
<div class="line"><span class="lineno">  369</span>    </div>
<div class="line"><span class="lineno">  370</span>    <span class="comment">// 2. Create sample traces</span></div>
<div class="line"><span class="lineno">  371</span>    std::vector&lt;trace_span&gt; test_spans;</div>
<div class="line"><span class="lineno">  372</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 10; ++i) {</div>
<div class="line"><span class="lineno">  373</span>        trace_span span;</div>
<div class="line"><span class="lineno">  374</span>        span.trace_id = <span class="stringliteral">&quot;trace_&quot;</span> + std::to_string(i);</div>
<div class="line"><span class="lineno">  375</span>        span.span_id = <span class="stringliteral">&quot;span_&quot;</span> + std::to_string(i);</div>
<div class="line"><span class="lineno">  376</span>        span.operation_name = <span class="stringliteral">&quot;operation_&quot;</span> + std::to_string(i);</div>
<div class="line"><span class="lineno">  377</span>        span.start_time = std::chrono::system_clock::now();</div>
<div class="line"><span class="lineno">  378</span>        span.end_time = span.start_time + std::chrono::milliseconds(100);</div>
<div class="line"><span class="lineno">  379</span>        span.set_attribute(<span class="stringliteral">&quot;index&quot;</span>, std::to_string(i));</div>
<div class="line"><span class="lineno">  380</span>        test_spans.push_back(span);</div>
<div class="line"><span class="lineno">  381</span>    }</div>
<div class="line"><span class="lineno">  382</span>    </div>
<div class="line"><span class="lineno">  383</span>    <span class="comment">// 3. Export spans</span></div>
<div class="line"><span class="lineno">  384</span>    <span class="keyword">auto</span> export_result = otel_adapter-&gt;export_spans(test_spans);</div>
<div class="line"><span class="lineno">  385</span>    EXPECT_TRUE(export_result);</div>
<div class="line"><span class="lineno">  386</span>    </div>
<div class="line"><span class="lineno">  387</span>    <span class="comment">// 4. Verify export stats</span></div>
<div class="line"><span class="lineno">  388</span>    <span class="keyword">auto</span> stats = otel_adapter-&gt;get_stats();</div>
<div class="line"><span class="lineno">  389</span>    EXPECT_EQ(stats.pending_spans, test_spans.size());</div>
<div class="line"><span class="lineno">  390</span>    </div>
<div class="line"><span class="lineno">  391</span>    <span class="comment">// 5. Create sample metrics</span></div>
<div class="line"><span class="lineno">  392</span>    monitoring_data test_data(<span class="stringliteral">&quot;export_test&quot;</span>);</div>
<div class="line"><span class="lineno">  393</span>    test_data.add_metric(<span class="stringliteral">&quot;cpu_usage&quot;</span>, 75.0);</div>
<div class="line"><span class="lineno">  394</span>    test_data.add_metric(<span class="stringliteral">&quot;memory_usage&quot;</span>, 60.0);</div>
<div class="line"><span class="lineno">  395</span>    test_data.add_metric(<span class="stringliteral">&quot;request_count&quot;</span>, 1000.0);</div>
<div class="line"><span class="lineno">  396</span>    </div>
<div class="line"><span class="lineno">  397</span>    <span class="comment">// 6. Export metrics</span></div>
<div class="line"><span class="lineno">  398</span>    <span class="keyword">auto</span> metrics_result = otel_adapter-&gt;export_metrics(test_data);</div>
<div class="line"><span class="lineno">  399</span>    EXPECT_TRUE(metrics_result);</div>
<div class="line"><span class="lineno">  400</span>    </div>
<div class="line"><span class="lineno">  401</span>    <span class="comment">// 7. Verify combined stats</span></div>
<div class="line"><span class="lineno">  402</span>    stats = otel_adapter-&gt;get_stats();</div>
<div class="line"><span class="lineno">  403</span>    EXPECT_GT(stats.pending_metrics, 0);</div>
<div class="line"><span class="lineno">  404</span>    </div>
<div class="line"><span class="lineno">  405</span>    <span class="comment">// 8. Flush all pending data</span></div>
<div class="line"><span class="lineno">  406</span>    <span class="keyword">auto</span> flush_result = otel_adapter-&gt;flush();</div>
<div class="line"><span class="lineno">  407</span>    EXPECT_TRUE(flush_result);</div>
<div class="line"><span class="lineno">  408</span>    </div>
<div class="line"><span class="lineno">  409</span>    <span class="comment">// 9. Verify flush completed</span></div>
<div class="line"><span class="lineno">  410</span>    stats = otel_adapter-&gt;get_stats();</div>
<div class="line"><span class="lineno">  411</span>    EXPECT_EQ(stats.pending_spans, 0);</div>
<div class="line"><span class="lineno">  412</span>    EXPECT_EQ(stats.pending_metrics, 0);</div>
<div class="line"><span class="lineno">  413</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a44e20b27be624999bd30ba9315acf094" name="a44e20b27be624999bd30ba9315acf094"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a44e20b27be624999bd30ba9315acf094">&#9670;&#160;</a></span>TEST_F() <span class="overload">[5/8]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TEST_F </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d9/d92/classIntegrationE2ETest.html">IntegrationE2ETest</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">FullSystemLoadTest&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Test 7: Full System Load Test High volume → All components → Performance verification </p>

<p class="definition">Definition at line <a class="el" href="../../d1/d9b/test__integration__e2e_8cpp_source.html#l00419">419</a> of file <a class="el" href="../../d1/d9b/test__integration__e2e_8cpp_source.html">test_integration_e2e.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  419</span>                                               {</div>
<div class="line"><span class="lineno">  420</span>    <span class="comment">// 1. Setup components</span></div>
<div class="line"><span class="lineno">  421</span>    <span class="keyword">auto</span> tracer = std::make_unique&lt;distributed_tracer&gt;(<span class="stringliteral">&quot;load_test&quot;</span>);</div>
<div class="line"><span class="lineno">  422</span>    <span class="keyword">auto</span> perf_monitor = performance_monitor::create();</div>
<div class="line"><span class="lineno">  423</span>    <span class="keyword">auto</span> health_monitor = global_health_monitor::instance();</div>
<div class="line"><span class="lineno">  424</span>    </div>
<div class="line"><span class="lineno">  425</span>    <span class="comment">// 2. Configure for high load</span></div>
<div class="line"><span class="lineno">  426</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> num_operations = 1000;</div>
<div class="line"><span class="lineno">  427</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> num_threads = 10;</div>
<div class="line"><span class="lineno">  428</span>    </div>
<div class="line"><span class="lineno">  429</span>    <span class="comment">// 3. Generate load</span></div>
<div class="line"><span class="lineno">  430</span>    <span class="keyword">auto</span> start_time = std::chrono::steady_clock::now();</div>
<div class="line"><span class="lineno">  431</span>    std::vector&lt;std::thread&gt; load_generators;</div>
<div class="line"><span class="lineno">  432</span>    std::atomic&lt;int&gt; total_operations{0};</div>
<div class="line"><span class="lineno">  433</span>    </div>
<div class="line"><span class="lineno">  434</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> t = 0; t &lt; num_threads; ++t) {</div>
<div class="line"><span class="lineno">  435</span>        load_generators.emplace_back([&amp;tracer, &amp;total_operations, t, num_operations]() {</div>
<div class="line"><span class="lineno">  436</span>            std::random_device rd;</div>
<div class="line"><span class="lineno">  437</span>            std::mt19937 gen(rd());</div>
<div class="line"><span class="lineno">  438</span>            std::uniform_real_distribution&lt;&gt; dis(0.0, 100.0);</div>
<div class="line"><span class="lineno">  439</span>            </div>
<div class="line"><span class="lineno">  440</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; num_operations / num_threads; ++i) {</div>
<div class="line"><span class="lineno">  441</span>                <span class="comment">// Create span</span></div>
<div class="line"><span class="lineno">  442</span>                <span class="keyword">auto</span> span_result = tracer-&gt;start_span(<span class="stringliteral">&quot;load_test_&quot;</span> + std::to_string(t));</div>
<div class="line"><span class="lineno">  443</span>                <span class="keywordflow">if</span> (span_result) {</div>
<div class="line"><span class="lineno">  444</span>                    span_result.value().set_attribute(<span class="stringliteral">&quot;thread&quot;</span>, std::to_string(t));</div>
<div class="line"><span class="lineno">  445</span>                    span_result.value().set_attribute(<span class="stringliteral">&quot;value&quot;</span>, std::to_string(dis(gen)));</div>
<div class="line"><span class="lineno">  446</span>                    total_operations++;</div>
<div class="line"><span class="lineno">  447</span>                }</div>
<div class="line"><span class="lineno">  448</span>                </div>
<div class="line"><span class="lineno">  449</span>                <span class="comment">// Small delay to prevent overwhelming</span></div>
<div class="line"><span class="lineno">  450</span>                <span class="keywordflow">if</span> (i % 10 == 0) {</div>
<div class="line"><span class="lineno">  451</span>                    std::this_thread::sleep_for(std::chrono::microseconds(100));</div>
<div class="line"><span class="lineno">  452</span>                }</div>
<div class="line"><span class="lineno">  453</span>            }</div>
<div class="line"><span class="lineno">  454</span>        });</div>
<div class="line"><span class="lineno">  455</span>    }</div>
<div class="line"><span class="lineno">  456</span>    </div>
<div class="line"><span class="lineno">  457</span>    <span class="comment">// 4. Monitor while load is running</span></div>
<div class="line"><span class="lineno">  458</span>    std::thread monitor_thread([&amp;health_monitor, &amp;start_time]() {</div>
<div class="line"><span class="lineno">  459</span>        <span class="keywordflow">while</span> (std::chrono::steady_clock::now() - start_time &lt; std::chrono::seconds(5)) {</div>
<div class="line"><span class="lineno">  460</span>            <span class="keyword">auto</span> health = health_monitor-&gt;check_health();</div>
<div class="line"><span class="lineno">  461</span>            <span class="comment">// System should remain healthy under load</span></div>
<div class="line"><span class="lineno">  462</span>            EXPECT_TRUE(health.is_operational());</div>
<div class="line"><span class="lineno">  463</span>            std::this_thread::sleep_for(std::chrono::milliseconds(100));</div>
<div class="line"><span class="lineno">  464</span>        }</div>
<div class="line"><span class="lineno">  465</span>    });</div>
<div class="line"><span class="lineno">  466</span>    </div>
<div class="line"><span class="lineno">  467</span>    <span class="comment">// 5. Wait for completion</span></div>
<div class="line"><span class="lineno">  468</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; t : load_generators) {</div>
<div class="line"><span class="lineno">  469</span>        t.join();</div>
<div class="line"><span class="lineno">  470</span>    }</div>
<div class="line"><span class="lineno">  471</span>    monitor_thread.join();</div>
<div class="line"><span class="lineno">  472</span>    </div>
<div class="line"><span class="lineno">  473</span>    <span class="keyword">auto</span> end_time = std::chrono::steady_clock::now();</div>
<div class="line"><span class="lineno">  474</span>    <span class="keyword">auto</span> duration = std::chrono::duration_cast&lt;std::chrono::milliseconds&gt;(end_time - start_time);</div>
<div class="line"><span class="lineno">  475</span>    </div>
<div class="line"><span class="lineno">  476</span>    <span class="comment">// 6. Verify performance</span></div>
<div class="line"><span class="lineno">  477</span>    EXPECT_EQ(total_operations, num_operations);</div>
<div class="line"><span class="lineno">  478</span>    </div>
<div class="line"><span class="lineno">  479</span>    <span class="comment">// Calculate throughput</span></div>
<div class="line"><span class="lineno">  480</span>    <span class="keywordtype">double</span> throughput = (total_operations * 1000.0) / duration.count();</div>
<div class="line"><span class="lineno">  481</span>    std::cout &lt;&lt; <span class="stringliteral">&quot;Load test throughput: &quot;</span> &lt;&lt; throughput &lt;&lt; <span class="stringliteral">&quot; ops/sec&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  482</span>    </div>
<div class="line"><span class="lineno">  483</span>    <span class="comment">// Should achieve reasonable throughput</span></div>
<div class="line"><span class="lineno">  484</span>    EXPECT_GT(throughput, 100.0); <span class="comment">// At least 100 ops/sec</span></div>
<div class="line"><span class="lineno">  485</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a682e953c7e7637be353153a0ee81b9e1" name="a682e953c7e7637be353153a0ee81b9e1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a682e953c7e7637be353153a0ee81b9e1">&#9670;&#160;</a></span>TEST_F() <span class="overload">[6/8]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TEST_F </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d9/d92/classIntegrationE2ETest.html">IntegrationE2ETest</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">HealthMonitoringWithRecovery&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Test 3: Health Monitoring with Fault Recovery Health checks → Failure detection → Recovery → Verification </p>

<p class="definition">Definition at line <a class="el" href="../../d1/d9b/test__integration__e2e_8cpp_source.html#l00179">179</a> of file <a class="el" href="../../d1/d9b/test__integration__e2e_8cpp_source.html">test_integration_e2e.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  179</span>                                                         {</div>
<div class="line"><span class="lineno">  180</span>    <span class="comment">// 1. Setup health monitoring</span></div>
<div class="line"><span class="lineno">  181</span>    <span class="keyword">auto</span> health_monitor = global_health_monitor::instance();</div>
<div class="line"><span class="lineno">  182</span>    fault_tolerance_manager ft_manager;</div>
<div class="line"><span class="lineno">  183</span>    </div>
<div class="line"><span class="lineno">  184</span>    <span class="comment">// 2. Register health checks</span></div>
<div class="line"><span class="lineno">  185</span>    std::atomic&lt;bool&gt; service_healthy{<span class="keyword">true</span>};</div>
<div class="line"><span class="lineno">  186</span>    </div>
<div class="line"><span class="lineno">  187</span>    health_monitor-&gt;register_check(<span class="stringliteral">&quot;database&quot;</span>, [&amp;service_healthy]() {</div>
<div class="line"><span class="lineno">  188</span>        <span class="keywordflow">if</span> (service_healthy) {</div>
<div class="line"><span class="lineno">  189</span>            <span class="keywordflow">return</span> health_check_result::healthy(<span class="stringliteral">&quot;Database connection OK&quot;</span>);</div>
<div class="line"><span class="lineno">  190</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  191</span>            <span class="keywordflow">return</span> health_check_result::unhealthy(<span class="stringliteral">&quot;Database connection failed&quot;</span>);</div>
<div class="line"><span class="lineno">  192</span>        }</div>
<div class="line"><span class="lineno">  193</span>    });</div>
<div class="line"><span class="lineno">  194</span>    </div>
<div class="line"><span class="lineno">  195</span>    health_monitor-&gt;register_check(<span class="stringliteral">&quot;cache&quot;</span>, []() {</div>
<div class="line"><span class="lineno">  196</span>        <span class="keywordflow">return</span> health_check_result::healthy(<span class="stringliteral">&quot;Cache service running&quot;</span>);</div>
<div class="line"><span class="lineno">  197</span>    });</div>
<div class="line"><span class="lineno">  198</span>    </div>
<div class="line"><span class="lineno">  199</span>    <span class="comment">// 3. Initial health check - should be healthy</span></div>
<div class="line"><span class="lineno">  200</span>    <span class="keyword">auto</span> initial_health = health_monitor-&gt;check_health();</div>
<div class="line"><span class="lineno">  201</span>    EXPECT_TRUE(initial_health.is_healthy());</div>
<div class="line"><span class="lineno">  202</span>    </div>
<div class="line"><span class="lineno">  203</span>    <span class="comment">// 4. Simulate failure</span></div>
<div class="line"><span class="lineno">  204</span>    service_healthy = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  205</span>    </div>
<div class="line"><span class="lineno">  206</span>    <span class="comment">// 5. Setup retry policy for recovery</span></div>
<div class="line"><span class="lineno">  207</span>    retry_policy policy;</div>
<div class="line"><span class="lineno">  208</span>    policy.max_attempts = 3;</div>
<div class="line"><span class="lineno">  209</span>    policy.initial_delay = std::chrono::milliseconds(10);</div>
<div class="line"><span class="lineno">  210</span>    policy.backoff_multiplier = 2.0;</div>
<div class="line"><span class="lineno">  211</span>    </div>
<div class="line"><span class="lineno">  212</span>    <span class="comment">// 6. Attempt recovery with fault tolerance</span></div>
<div class="line"><span class="lineno">  213</span>    <span class="keywordtype">int</span> recovery_attempts = 0;</div>
<div class="line"><span class="lineno">  214</span>    <span class="keyword">auto</span> recovery_result = ft_manager.execute_with_retry(</div>
<div class="line"><span class="lineno">  215</span>        [&amp;service_healthy, &amp;recovery_attempts]() -&gt; result_void {</div>
<div class="line"><span class="lineno">  216</span>            recovery_attempts++;</div>
<div class="line"><span class="lineno">  217</span>            <span class="keywordflow">if</span> (recovery_attempts &gt;= 2) {</div>
<div class="line"><span class="lineno">  218</span>                service_healthy = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  219</span>                <span class="keywordflow">return</span> make_void_success();</div>
<div class="line"><span class="lineno">  220</span>            }</div>
<div class="line"><span class="lineno">  221</span>            <span class="keywordflow">return</span> make_result_void(monitoring_error_code::operation_failed,</div>
<div class="line"><span class="lineno">  222</span>                                    <span class="stringliteral">&quot;Still recovering&quot;</span>);</div>
<div class="line"><span class="lineno">  223</span>        },</div>
<div class="line"><span class="lineno">  224</span>        policy</div>
<div class="line"><span class="lineno">  225</span>    );</div>
<div class="line"><span class="lineno">  226</span>    </div>
<div class="line"><span class="lineno">  227</span>    EXPECT_TRUE(recovery_result);</div>
<div class="line"><span class="lineno">  228</span>    EXPECT_GE(recovery_attempts, 2);</div>
<div class="line"><span class="lineno">  229</span>    </div>
<div class="line"><span class="lineno">  230</span>    <span class="comment">// 7. Verify health restored</span></div>
<div class="line"><span class="lineno">  231</span>    <span class="keyword">auto</span> final_health = health_monitor-&gt;check_health();</div>
<div class="line"><span class="lineno">  232</span>    EXPECT_TRUE(final_health.is_healthy());</div>
<div class="line"><span class="lineno">  233</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a592027d23ef36517b1967e304c0fbf01" name="a592027d23ef36517b1967e304c0fbf01"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a592027d23ef36517b1967e304c0fbf01">&#9670;&#160;</a></span>TEST_F() <span class="overload">[7/8]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TEST_F </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d9/d92/classIntegrationE2ETest.html">IntegrationE2ETest</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PerformanceAdaptiveOptimization&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Test 4: Performance Monitoring with Adaptive Optimization Monitoring → Load detection → Adaptation → Verification </p>

<p class="definition">Definition at line <a class="el" href="../../d1/d9b/test__integration__e2e_8cpp_source.html#l00239">239</a> of file <a class="el" href="../../d1/d9b/test__integration__e2e_8cpp_source.html">test_integration_e2e.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  239</span>                                                            {</div>
<div class="line"><span class="lineno">  240</span>    <span class="comment">// 1. Setup performance monitoring</span></div>
<div class="line"><span class="lineno">  241</span>    <span class="keyword">auto</span> perf_monitor = performance_monitor::create();</div>
<div class="line"><span class="lineno">  242</span>    adaptive_monitor adapter;</div>
<div class="line"><span class="lineno">  243</span>    </div>
<div class="line"><span class="lineno">  244</span>    <span class="comment">// 2. Configure adaptation strategy</span></div>
<div class="line"><span class="lineno">  245</span>    adaptive_config config;</div>
<div class="line"><span class="lineno">  246</span>    config.strategy = adaptation_strategy::balanced;</div>
<div class="line"><span class="lineno">  247</span>    config.cpu_threshold = 70.0;</div>
<div class="line"><span class="lineno">  248</span>    config.memory_threshold = 80.0;</div>
<div class="line"><span class="lineno">  249</span>    config.min_sampling_rate = 0.1;</div>
<div class="line"><span class="lineno">  250</span>    config.max_sampling_rate = 1.0;</div>
<div class="line"><span class="lineno">  251</span>    adapter.configure(config);</div>
<div class="line"><span class="lineno">  252</span>    </div>
<div class="line"><span class="lineno">  253</span>    <span class="comment">// 3. Simulate varying load</span></div>
<div class="line"><span class="lineno">  254</span>    std::vector&lt;double&gt; cpu_loads = {30, 45, 60, 75, 85, 90, 80, 65, 50, 35};</div>
<div class="line"><span class="lineno">  255</span>    </div>
<div class="line"><span class="lineno">  256</span>    <span class="keywordflow">for</span> (<span class="keywordtype">double</span> load : cpu_loads) {</div>
<div class="line"><span class="lineno">  257</span>        <span class="comment">// Simulate CPU load</span></div>
<div class="line"><span class="lineno">  258</span>        <span class="keyword">auto</span> cpu_metric = perf_monitor-&gt;measure_cpu_usage();</div>
<div class="line"><span class="lineno">  259</span>        </div>
<div class="line"><span class="lineno">  260</span>        <span class="comment">// Update adaptive monitor</span></div>
<div class="line"><span class="lineno">  261</span>        system_resource_info resources;</div>
<div class="line"><span class="lineno">  262</span>        resources.cpu_percent = load;</div>
<div class="line"><span class="lineno">  263</span>        resources.memory_percent = 60.0;</div>
<div class="line"><span class="lineno">  264</span>        adapter.update_system_load(resources);</div>
<div class="line"><span class="lineno">  265</span>        </div>
<div class="line"><span class="lineno">  266</span>        <span class="comment">// Check adaptation</span></div>
<div class="line"><span class="lineno">  267</span>        <span class="keyword">auto</span> current_load = adapter.get_current_load();</div>
<div class="line"><span class="lineno">  268</span>        <span class="keyword">auto</span> sampling_rate = adapter.get_current_sampling_rate();</div>
<div class="line"><span class="lineno">  269</span>        </div>
<div class="line"><span class="lineno">  270</span>        <span class="comment">// Higher load should reduce sampling rate</span></div>
<div class="line"><span class="lineno">  271</span>        <span class="keywordflow">if</span> (load &gt; 80) {</div>
<div class="line"><span class="lineno">  272</span>            EXPECT_EQ(current_load, load_level::critical);</div>
<div class="line"><span class="lineno">  273</span>            EXPECT_LT(sampling_rate, 0.5);</div>
<div class="line"><span class="lineno">  274</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (load &gt; 60) {</div>
<div class="line"><span class="lineno">  275</span>            EXPECT_EQ(current_load, load_level::high);</div>
<div class="line"><span class="lineno">  276</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  277</span>            EXPECT_LE(current_load, load_level::medium);</div>
<div class="line"><span class="lineno">  278</span>        }</div>
<div class="line"><span class="lineno">  279</span>        </div>
<div class="line"><span class="lineno">  280</span>        <span class="comment">// Small delay to simulate real monitoring</span></div>
<div class="line"><span class="lineno">  281</span>        std::this_thread::sleep_for(std::chrono::milliseconds(10));</div>
<div class="line"><span class="lineno">  282</span>    }</div>
<div class="line"><span class="lineno">  283</span>    </div>
<div class="line"><span class="lineno">  284</span>    <span class="comment">// 4. Verify final state</span></div>
<div class="line"><span class="lineno">  285</span>    <span class="keyword">auto</span> final_load = adapter.get_current_load();</div>
<div class="line"><span class="lineno">  286</span>    EXPECT_LE(final_load, load_level::medium);</div>
<div class="line"><span class="lineno">  287</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a488edffbb82c503b4fd8a79772a608c0" name="a488edffbb82c503b4fd8a79772a608c0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a488edffbb82c503b4fd8a79772a608c0">&#9670;&#160;</a></span>TEST_F() <span class="overload">[8/8]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TEST_F </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d9/d92/classIntegrationE2ETest.html">IntegrationE2ETest</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">StorageBackendIntegration&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Test 1: Storage Backend Integration Multiple backends → Concurrent operations → Data consistency </p>

<p class="definition">Definition at line <a class="el" href="../../d1/d9b/test__integration__e2e_8cpp_source.html#l00061">61</a> of file <a class="el" href="../../d1/d9b/test__integration__e2e_8cpp_source.html">test_integration_e2e.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   61</span>                                                      {</div>
<div class="line"><span class="lineno">   62</span>    <span class="comment">// 1. Create multiple storage backends</span></div>
<div class="line"><span class="lineno">   63</span>    storage_config file_config;</div>
<div class="line"><span class="lineno">   64</span>    file_config.type = storage_backend_type::file_json;</div>
<div class="line"><span class="lineno">   65</span>    file_config.path = (test_dir_ / <span class="stringliteral">&quot;metrics.json&quot;</span>).<span class="keywordtype">string</span>();</div>
<div class="line"><span class="lineno">   66</span>    file_config.max_capacity = 100;</div>
<div class="line"><span class="lineno">   67</span>    </div>
<div class="line"><span class="lineno">   68</span>    storage_config memory_config;</div>
<div class="line"><span class="lineno">   69</span>    memory_config.type = storage_backend_type::memory_buffer;</div>
<div class="line"><span class="lineno">   70</span>    memory_config.max_capacity = 100;</div>
<div class="line"><span class="lineno">   71</span>    </div>
<div class="line"><span class="lineno">   72</span>    <span class="keyword">auto</span> file_backend = std::make_unique&lt;file_storage_backend&gt;(file_config);</div>
<div class="line"><span class="lineno">   73</span>    <span class="keyword">auto</span> memory_backend = std::make_unique&lt;memory_storage_backend&gt;(memory_config);</div>
<div class="line"><span class="lineno">   74</span>    </div>
<div class="line"><span class="lineno">   75</span>    <span class="comment">// 2. Create test data</span></div>
<div class="line"><span class="lineno">   76</span>    std::vector&lt;metrics_snapshot&gt; snapshots;</div>
<div class="line"><span class="lineno">   77</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 50; ++i) {</div>
<div class="line"><span class="lineno">   78</span>        metrics_snapshot snapshot;</div>
<div class="line"><span class="lineno">   79</span>        snapshot.add_metric(<span class="stringliteral">&quot;metric_&quot;</span> + std::to_string(i), i * 1.5);</div>
<div class="line"><span class="lineno">   80</span>        snapshots.push_back(snapshot);</div>
<div class="line"><span class="lineno">   81</span>    }</div>
<div class="line"><span class="lineno">   82</span>    </div>
<div class="line"><span class="lineno">   83</span>    <span class="comment">// 3. Store data in both backends concurrently</span></div>
<div class="line"><span class="lineno">   84</span>    std::vector&lt;std::thread&gt; threads;</div>
<div class="line"><span class="lineno">   85</span>    std::atomic&lt;int&gt; success_count{0};</div>
<div class="line"><span class="lineno">   86</span>    </div>
<div class="line"><span class="lineno">   87</span>    <span class="comment">// Thread for file backend</span></div>
<div class="line"><span class="lineno">   88</span>    threads.emplace_back([&amp;file_backend, &amp;snapshots, &amp;success_count]() {</div>
<div class="line"><span class="lineno">   89</span>        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; snapshot : snapshots) {</div>
<div class="line"><span class="lineno">   90</span>            <span class="keyword">auto</span> result = file_backend-&gt;store(snapshot);</div>
<div class="line"><span class="lineno">   91</span>            <span class="keywordflow">if</span> (result.is_ok()) success_count++;</div>
<div class="line"><span class="lineno">   92</span>        }</div>
<div class="line"><span class="lineno">   93</span>    });</div>
<div class="line"><span class="lineno">   94</span>    </div>
<div class="line"><span class="lineno">   95</span>    <span class="comment">// Thread for memory backend</span></div>
<div class="line"><span class="lineno">   96</span>    threads.emplace_back([&amp;memory_backend, &amp;snapshots, &amp;success_count]() {</div>
<div class="line"><span class="lineno">   97</span>        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; snapshot : snapshots) {</div>
<div class="line"><span class="lineno">   98</span>            <span class="keyword">auto</span> result = memory_backend-&gt;store(snapshot);</div>
<div class="line"><span class="lineno">   99</span>            <span class="keywordflow">if</span> (result.is_ok()) success_count++;</div>
<div class="line"><span class="lineno">  100</span>        }</div>
<div class="line"><span class="lineno">  101</span>    });</div>
<div class="line"><span class="lineno">  102</span>    </div>
<div class="line"><span class="lineno">  103</span>    <span class="comment">// 4. Wait for completion</span></div>
<div class="line"><span class="lineno">  104</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; t : threads) {</div>
<div class="line"><span class="lineno">  105</span>        t.join();</div>
<div class="line"><span class="lineno">  106</span>    }</div>
<div class="line"><span class="lineno">  107</span>    </div>
<div class="line"><span class="lineno">  108</span>    EXPECT_EQ(success_count, snapshots.size() * 2);</div>
<div class="line"><span class="lineno">  109</span>    </div>
<div class="line"><span class="lineno">  110</span>    <span class="comment">// 5. Verify data consistency</span></div>
<div class="line"><span class="lineno">  111</span>    EXPECT_EQ(file_backend-&gt;size(), 50);</div>
<div class="line"><span class="lineno">  112</span>    EXPECT_EQ(memory_backend-&gt;size(), 50);</div>
<div class="line"><span class="lineno">  113</span>    </div>
<div class="line"><span class="lineno">  114</span>    <span class="comment">// 6. Test retrieval</span></div>
<div class="line"><span class="lineno">  115</span>    <span class="keyword">auto</span> file_result = file_backend-&gt;retrieve(0);</div>
<div class="line"><span class="lineno">  116</span>    <span class="keyword">auto</span> memory_result = memory_backend-&gt;retrieve(0);</div>
<div class="line"><span class="lineno">  117</span>    </div>
<div class="line"><span class="lineno">  118</span>    EXPECT_TRUE(file_result);</div>
<div class="line"><span class="lineno">  119</span>    EXPECT_TRUE(memory_result);</div>
<div class="line"><span class="lineno">  120</span>    </div>
<div class="line"><span class="lineno">  121</span>    <span class="comment">// 7. Test flush</span></div>
<div class="line"><span class="lineno">  122</span>    <span class="keyword">auto</span> flush_file = file_backend-&gt;flush();</div>
<div class="line"><span class="lineno">  123</span>    <span class="keyword">auto</span> flush_memory = memory_backend-&gt;flush();</div>
<div class="line"><span class="lineno">  124</span>    </div>
<div class="line"><span class="lineno">  125</span>    EXPECT_TRUE(flush_file);</div>
<div class="line"><span class="lineno">  126</span>    EXPECT_TRUE(flush_memory);</div>
<div class="line"><span class="lineno">  127</span>}</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sat Dec 6 2025 11:57:43 for Monitoring System by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
